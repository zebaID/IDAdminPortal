!function(e,o){"undefined"!=typeof module&&module.exports?module.exports=o(require("angular")):"function"==typeof define&&define.amd?define(["angular"],o):o(e.angular)}(this,function(e){"use strict";var o=e.module("ngDialog",[]),n=e.element,a=e.isDefined,l=(document.body||document.documentElement).style,i=a(l.animation)||a(l.WebkitAnimation)||a(l.MozAnimation)||a(l.MsAnimation)||a(l.OAnimation),t="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",s=!1;o.provider("ngDialog",function(){var o=this.defaults={className:"ngdialog-theme-default",plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0};this.setForceBodyReload=function(e){s=e||!1},this.setDefaults=function(n){e.extend(o,n)};var a,l=0,c=0,r={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(d,g,p,u,m,f,C,D,v){var y=d.find("body");s&&f.$on("$locationChangeSuccess",function(){y=d.find("body")});var h={onDocumentKeydown:function(e){27===e.keyCode&&$.close("$escape")},setBodyPadding:function(e){var o=parseInt(y.css("padding-right")||0,10);y.css("padding-right",o+e+"px"),y.data("ng-dialog-original-padding",o)},resetBodyPadding:function(){var e=y.data("ng-dialog-original-padding");e?y.css("padding-right",e+"px"):y.css("padding-right","")},performCloseDialog:function(o,n){var l=o.attr("id");if("undefined"!=typeof D.Hammer){var s=e.element(o).scope().hammerTime;s.off("tap",a),s.destroy&&s.destroy(),delete o.scope().hammerTime}else o.unbind("click");1===c&&y.unbind("keydown"),o.hasClass("ngdialog-closing")||(c-=1),f.$broadcast("ngDialog.closing",o),i?o.unbind(t).bind(t,function(){o.scope().$destroy(),o.remove(),0===c&&(y.removeClass("ngdialog-open"),h.resetBodyPadding()),f.$broadcast("ngDialog.closed",o)}).addClass("ngdialog-closing"):(o.scope().$destroy(),o.remove(),0===c&&(y.removeClass("ngdialog-open"),h.resetBodyPadding()),f.$broadcast("ngDialog.closed",o)),r[l]&&(r[l].resolve({id:l,value:n,$dialog:o,remainingDialogs:c}),delete r[l])},closeDialog:function(o,n){var a=o.data("$ngDialogPreCloseCallback");if(a&&e.isFunction(a)){var l=a.call(o,n);e.isObject(l)?l.closePromise?l.closePromise.then(function(){h.performCloseDialog(o,n)}):l.then(function(){h.performCloseDialog(o,n)},function(){}):l!==!1&&h.performCloseDialog(o,n)}else h.performCloseDialog(o,n)}},$={open:function(i){function t(e,o){return m.get(e,o||{}).then(function(e){return e.data||""})}function s(o){return o?e.isString(o)&&b.plain?o:"boolean"!=typeof b.cache||b.cache?g.get(o)||t(o,{cache:!0}):t(o,{cache:!1}):"Empty template"}var d=this,b=e.copy(o);i=i||{},e.extend(b,i),l+=1,d.latestID="ngdialog"+l;var k;r[d.latestID]=k=u.defer();var B,w,S=e.isObject(b.scope)?b.scope.$new():f.$new();return u.when(s(b.template||b.templateUrl)).then(function(o){if(g.put(b.template||b.templateUrl,o),b.showClose&&(o+='<div class="ngdialog-close"></div>'),d.$result=B=n('<div id="ngdialog'+l+'" class="ngdialog"></div>'),B.html(b.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content">'+o+"</div>":'<div class="ngdialog-content">'+o+"</div>"),b.data&&e.isString(b.data)){var i=b.data.replace(/^\s*/,"")[0];S.ngDialogData="{"===i||"["===i?e.fromJson(b.data):b.data}else b.data&&e.isObject(b.data)&&(S.ngDialogData=b.data);if(b.controller&&(e.isString(b.controller)||e.isArray(b.controller)||e.isFunction(b.controller))){var t=v(b.controller,{$scope:S,$element:B});B.data("$ngDialogControllerController",t)}if(b.className&&B.addClass(b.className),w=b.appendTo&&e.isString(b.appendTo)?e.element(document.querySelector(b.appendTo)):y,b.preCloseCallback){var s;e.isFunction(b.preCloseCallback)?s=b.preCloseCallback:e.isString(b.preCloseCallback)&&S&&(e.isFunction(S[b.preCloseCallback])?s=S[b.preCloseCallback]:S.$parent&&e.isFunction(S.$parent[b.preCloseCallback])?s=S.$parent[b.preCloseCallback]:f&&e.isFunction(f[b.preCloseCallback])&&(s=f[b.preCloseCallback])),s&&B.data("$ngDialogPreCloseCallback",s)}if(S.closeThisDialog=function(e){h.closeDialog(B,e)},C(function(){p(B)(S);var e=D.innerWidth-y.prop("clientWidth");y.addClass("ngdialog-open");var o=e-(D.innerWidth-y.prop("clientWidth"));o>0&&h.setBodyPadding(o),w.append(B),b.name?f.$broadcast("ngDialog.opened",{dialog:B,name:b.name}):f.$broadcast("ngDialog.opened",B)}),b.closeByEscape&&y.bind("keydown",h.onDocumentKeydown),b.closeByNavigation&&f.$on("$locationChangeSuccess",function(){h.closeDialog(B)}),a=function(e){var o=b.closeByDocument?n(e.target).hasClass("ngdialog-overlay"):!1,a=n(e.target).hasClass("ngdialog-close");(o||a)&&$.close(B.attr("id"),a?"$closeButton":"$document")},"undefined"!=typeof D.Hammer){var r=S.hammerTime=D.Hammer(B[0]);r.on("tap",a)}else B.bind("click",a);return c+=1,$}),{id:"ngdialog"+l,closePromise:k.promise,close:function(e){h.closeDialog(B,e)}}},openConfirm:function(o){var a=u.defer(),l={closeByEscape:!1,closeByDocument:!1};e.extend(l,o),l.scope=e.isObject(l.scope)?l.scope.$new():f.$new(),l.scope.confirm=function(e){a.resolve(e);var o=n(document.getElementById(i.id));h.performCloseDialog(o,e)};var i=$.open(l);return i.closePromise.then(function(e){return e?a.reject(e.value):a.reject()}),a.promise},close:function(e,o){var a=n(document.getElementById(e));return a.length?h.closeDialog(a,o):$.closeAll(o),$},closeAll:function(o){var a=document.querySelectorAll(".ngdialog");e.forEach(a,function(e){h.closeDialog(n(e),o)})},getDefaults:function(){return o}};return $}]}),o.directive("ngDialog",["ngDialog",function(o){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,a,l){a.on("click",function(a){a.preventDefault();var i=e.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";e.isDefined(l.ngDialogClosePrevious)&&o.close(l.ngDialogClosePrevious);var t=o.getDefaults();o.open({template:l.ngDialog,className:l.ngDialogClass||t.className,controller:l.ngDialogController,scope:i,data:l.ngDialogData,showClose:"false"===l.ngDialogShowClose?!1:"true"===l.ngDialogShowClose?!0:t.showClose,closeByDocument:"false"===l.ngDialogCloseByDocument?!1:"true"===l.ngDialogCloseByDocument?!0:t.closeByDocument,closeByEscape:"false"===l.ngDialogCloseByEscape?!1:"true"===l.ngDialogCloseByEscape?!0:t.closeByEscape,preCloseCallback:l.ngDialogPreCloseCallback||t.preCloseCallback})})}}}])});